{% extends 'masque_EME/base.html' %}

{% block content %}
{% load static %}

<div class="container">
    <div class="row">
        <div class="col-md-6 offset-md-3">
            <h3>Générer les PRE40 et PRE20</h3>
            <form method="post" enctype="multipart/form-data" id="pdf-upload-form">
                {% csrf_token %}
                <div id="drop-zone" class="mb-3">
                    <p>Glisser & Déposer la PRE25</p>
                </div>
                {{ form.as_p }}
                <button type="submit" class="btn btn-primary">Envoyer</button>
            </form>

            <!-- Include additional parts to show the PDF text and link -->
            {% if extracted_info %}
            <div>
                {% for key, value in extracted_info.items %}
                    <p><strong>{{ key }}:</strong> {{ value }}</p>
                {% endfor %}
            </div>
            {% endif %}
        

            {% if file_url %}
                <p>
                    PRE 25 envoyée! 
                    <a href="{{ file_url }}" target="_blank">Voir la PRE25 originale</a>.
                </p>
            {% endif %}
            
            <!-- Add this part to download the modified docx file -->
            {% if modified_docx_url %}
                <p>
                    <a href="{{ modified_docx_url }}" download>Télécharger le document modifié</a>.
                </p>
            {% endif %}

            {% comment %} <pre>{{ raw_extracted_text }}</pre> {% endcomment %}

        </div>
    </div>
</div>

<!-- Other links -->
<a href="{{ file_url }}" target="_blank">Voir la PRE25 originale</a>.
<a href="{% static 'Skoll/docx/PRE40.docx' %}" download>Download Template PRE40</a>

{% endblock %}

{% block js %}
<script>
    // ... (your existing JavaScript code)
</script>
{% endblock %}
